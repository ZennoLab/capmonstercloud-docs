---
sidebar_position: 1
sidebar_label: reCAPTCHA v3
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ParamItem from '@theme/ParamItem';
import MethodItem from '@theme/MethodItem';
import MethodDescription from '@theme/MethodDescription'
import PriceBlock from '../../../../../src/theme/PriceBlock';
import PriceBlockWrap from '@theme/PriceBlockWrap';
import BlogLink from '@theme/BlogLink';
import { ArticleHead } from '../../../../../src/theme/ArticleHead';

<ArticleHead slug="captchas/recaptcha-v3-task" />

# reCAPTCHA v3

<PriceBlockWrap>
  <PriceBlock title="RecaptchaV3TaskProxyless" captchaId="recaptcha3"/>
</PriceBlockWrap>

![](./images/recaptcha-v3/recaptchaV3.png)

:::warning **Atenção!**
A tarefa é executada através dos nossos próprios servidores proxy. Não há custos adicionais com proxies — o uso deles já está incluído no preço.
:::

Esta seção descreve a tarefa para resolver o Google reCAPTCHA v3.

O reCAPTCHA v3 funciona totalmente em segundo plano e não exige que o usuário realize qualquer ação. O sistema analisa sinais comportamentais e técnicos do visitante da página e gera uma pontuação de risco para cada solicitação. Com base nesses dados, o site decide se a ação é permitida, utilizando uma pontuação de confiança que normalmente varia de **0.1** a **0.9**.

Ao criar uma tarefa, é recomendável fornecer dois parâmetros: `pageAction` e `minScore`.

## Parâmetros da solicitação


<TabItem value="proxyless" label="RecaptchaV3TaskProxyless (sem proxy)" default className="bordered-panel">
    <ParamItem title="type" required type="string" />
    **RecaptchaV3TaskProxyless**

    ---

    <ParamItem title="websiteURL" required type="string" />
    Endereço da página da web com Google ReCaptcha.

    ---

    <ParamItem title="websiteKey" required type="string" />
   Chave do site Recaptcha.<br/>https://www.google.com/recaptcha/api.js?render=ESTA_AQUI

   ---

   <ParamItem title="isEnterprise" type="boolean" />
    Versão do reCAPTCHA. Valores suportados: `true` / `false` (também `1` / `0`, tipo inteiro).
    
    Defina `true` se precisar resolver o reCAPTCHA como Enterprise — nesse caso, a tarefa será processada da mesma forma que [RecaptchaV3EnterpriseTask](https://docs.capmonster.cloud/ru/docs/captchas/recaptcha-v3-enterprise-task/).

    ---

   <ParamItem title="minScore" type="double" />
    Valor de 0,1 a 0,9

    ---

    <ParamItem title="pageAction" type="string" />
    <p>Valor de ação do widget. O proprietário do site define o que o usuário está fazendo na página através deste parâmetro. Valor padrão: *verify*</p><p>Exemplo:<br/>*`grecaptcha.execute('site_key', {action:'login_test'})`*.</p>
</TabItem>


## Método de criar tarefa


<TabItem value="proxyless" label="RecaptchaV2TaskProxyless (sem proxy)" default className="method-panel">
<MethodItem>
  ```http
  https://api.capmonster.cloud/createTask
  ```
</MethodItem>
<MethodDescription>
**Solicitação**
```json
{
  "clientKey":"API_KEY",
  "task": {
    "type":"RecaptchaV3TaskProxyless",
    "websiteURL":"https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta",
    "websiteKey":"6Le0xVgUAAAAAIt20XEB4rVhYOODgTl00d8juDob",
    "isEnterprise": false,
    "minScore": 0.7,
    "pageAction": "myverify"
  }
}
```
**Resposta**
```json
{
  "errorId":0,
  "taskId":407533072
}
```

</MethodDescription>
</TabItem>

## Método de obter resultado da tarefa

:::warning **Aviso!**
Em alguns sites, é importante que o UserAgent corresponda ao usado ao resolver o captcha. Portanto, se o CapMonster Cloud retornar um UserAgent junto com o token, **sempre** aplique-o ao enviar o formulário ou confirmar a solução na página de destino.
:::

Use o método [getTaskResult](../api/methods/get-task-result.mdx) para solicitar a resposta do ReCaptcha3. Você receberá a resposta dentro de um período de 10 a 30 segundos, dependendo da carga de trabalho do serviço.

<TabItem value="proxyless" label="GeeTestTaskProxyless (sem proxy)" default className="method-panel-full">
    <MethodItem>
```http
https://api.capmonster.cloud/getTaskResult
```
    </MethodItem>
    <MethodDescription>
**Solicitação**
```json
{
  "clientKey":"API_KEY",
  "taskId": 407533072
}
```
**Resposta**
```json
{
  "errorId":0,
  "status":"ready",
  "solution": {
    "gRecaptchaResponse":"3AHJ_VuvYIBNBW5yyv0zRYJ75VkOKvhKj9_xGBJKnQimF72rfoq3Iy-DyGHMwLAo6a3"
  }
}
```
    Para alguns sites, a resposta pode ser semelhante à seguinte. Ao enviar a solução, certifique-se de usar o UserAgent fornecido na resposta, mesmo que seja diferente do que está atualmente sendo usado pelo seu navegador ou script.
 
```json
{
  "errorId": 0,
  "status": "ready",
  "solution": {
    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36",
    "gRecaptchaResponse": "0cAFcWeA5Y3...hF8UWA",
    "cookies": {
      "nocookies": "true"
    }
  }
}
```
  </MethodDescription>
  </TabItem>

<br />

|**Propriedade**|**Tipo**|**Descrição**|
| :- | :- | :- |
|gRecaptchaResponse|String|Hash que deve ser inserido no formulário de envio do Recaptcha3 em `<textarea id="g-recaptcha-response" ></textarea>`. Tem um comprimento de 500 a 2190 bytes.|

## Como Encontrar Todos os Parâmetros Necessários para a Criação da Tarefa

### Manualmente

1. Abra seu site onde o captcha aparece no navegador.
2. Clique com o botão direito no elemento do captcha e selecione **Inspecionar**.

#### websiteKey

A chave pública do site (sitekey). Normalmente, pode ser encontrada no script incluído:

Em **Elements**:

![elements](images\recaptcha-v3\sitekey-elements.png)

Na aba **Network**:

![network](images\recaptcha-v3\sitekey-network.png)

#### pageAction

O nome da ação passada para *grecaptcha.execute()*. Por exemplo:

![action](images\recaptcha-v3\action.png)

### Automaticamente

Para automatizar a extração dos parâmetros, eles podem ser obtidos via **navegador** (normal ou headless, por exemplo, usando **Playwright**) ou diretamente a partir de **requisições HTTP**. Como os valores dos parâmetros dinâmicos têm curta duração, recomenda-se utilizá-los imediatamente após a extração.

:::warning **Importante!**
Os trechos de código fornecidos são exemplos básicos para aprendizado sobre como extrair os parâmetros necessários. A implementação exata dependerá do seu site com captcha, sua estrutura e os elementos HTML e seletores utilizados.
:::

<Tabs className="full-width-tabs filled-tabs request-tabs">
  <TabItem value="js" label="JavaScript" default className="method-panel">
    <details>
      <summary>Mostrar código (no navegador)</summary>

      ```js
      (() => {
          const originalGrecaptcha = window.grecaptcha;

          if (!originalGrecaptcha || !originalGrecaptcha.execute) {
              console.warn("grecaptcha.execute não encontrado. Aguarde até que seja carregado.");
              return;
          }

          window.__extractedParams = null;

          window.grecaptcha = {
              ...originalGrecaptcha,
              execute: function(sitekey, config) {
                  console.log("Capturado!");
                  console.log("sitekey:", sitekey);
                  console.log("action:", config?.action);
                  window.__extractedParams = {
                      sitekey,
                      action: config?.action
                  };

                  return originalGrecaptcha.execute(sitekey, config);
              },
              ready: originalGrecaptcha.ready
          };

          console.log("grecaptcha.execute foi envolvido. Clique no botão - os parâmetros serão capturados.");
      })();
      ```
    </details>

    <details>
      <summary>Mostrar código (Node.js)</summary>

      ```js
      import { chromium } from "playwright";

      (async () => {
        const browser = await chromium.launch({ headless: false });
        const context = await browser.newContext();
        const page = await context.newPage();

        const jsContents = [];

        page.on("response", async (response) => {
          try {
            const url = response.url();
            const ct = response.headers()["content-type"] || "";
            if (ct.includes("javascript") || url.endsWith(".js")) {
              const text = await response.text();
              jsContents.push(text);
            }
          } catch (e) {}
        });

        const targetUrl = "https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta";
        await page.goto(targetUrl, { timeout: 60000 });
        await page.waitForTimeout(3000);

        const inlineScripts = await page.$$eval("script:not([src])", (scripts) =>
          scripts.map((s) => s.textContent)
        );
        jsContents.push(...inlineScripts);

        const executeRegex =
          /grecaptcha\.execute\(\s*['"]
          (?<sitekey>[^'"]+)['"]\s*,\s*\{[^}]*action\s*:\s*['"](?<action>[^'"]+)['"]/i;

        let foundSitekey = null;
        let foundAction = null;

        for (const js of jsContents) {
          const match = js.match(executeRegex);
          if (match && match.groups) {
            foundSitekey = match.groups.sitekey;
            foundAction = match.groups.action;
            break;
          }
        }

        console.log({
          sitekey: foundSitekey,
          action: foundAction,
        });

        await browser.close();
      })();
      ```
    </details>
  </TabItem>

  <TabItem value="python" label="Python" className="method-panel">
    <details>
      <summary>Mostrar código</summary>

      ```python
      import asyncio
      import re
      from playwright.async_api import async_playwright

      async def extract_recaptcha_v3_execute(url):
          async with async_playwright() as p:
              browser = await p.chromium.launch(headless=False)
              context = await browser.new_context()
              page = await context.new_page()

              execute_pattern = re.compile(
                  r"grecaptcha\.execute\(\s*['\"]"
                  r"(?P<sitekey>[^'\"]+)['\"]\s*,\s*\{[^}]*action\s*:\s*['\"](?P<action>[^'\"]+)['\"]",
                  re.IGNORECASE
              )

              found_sitekey = None
              found_action = None
              js_contents = []

              async def handle_response(response):
                  try:
                      ct = response.headers.get("content-type", "")
                      if "javascript" in ct or response.url.endswith(".js"):
                          text = await response.text()
                          js_contents.append(text)
                  except:
                      pass

              page.on("response", handle_response)

              await page.goto(url, timeout=60000)
              await page.wait_for_timeout(3000)

              inline_scripts = await page.locator("script:not([src])").all_text_contents()
              js_contents += inline_scripts

              for js in js_contents:
                  match = execute_pattern.search(js)
                  if match:
                      found_sitekey = match.group("sitekey")
                      found_action = match.group("action")
                      break

              await browser.close()

              print({
                  "sitekey": found_sitekey,
                  "action": found_action
              })

      asyncio.run(extract_recaptcha_v3_execute("https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta"))
      ```
    </details>
  </TabItem>

  <TabItem value="csharp" label="C#" className="method-panel">
    <details>
      <summary>Mostrar código</summary>

      ```csharp
      using System;
      using System.Text.RegularExpressions;
      using System.Threading.Tasks;
      using Microsoft.Playwright;
      using System.Collections.Generic;

      class Program
      {
          public static async Task Main(string[] args)
          {
              await ExtractRecaptchaV3Execute
              ("https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta");
          }

          public static async Task ExtractRecaptchaV3Execute(string url)
          {
              using var playwright = await Playwright.CreateAsync();
              var browser = await playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions
              {
                  Headless = false
              });

              var context = await browser.NewContextAsync();
              var page = await context.NewPageAsync();

              string foundSitekey = null;
              string foundAction = null;
              var jsContents = new List<string>();

              page.Response += async (_, response) =>
              {
                  try
                  {
                      var ct = response.Headers.ContainsKey("content-type") ? 
                      response.Headers["content-type"] : "";
                      if ((ct != null && ct.Contains("javascript")) || response.Url.EndsWith(".js"))
                      {
                          var text = await response.TextAsync();
                          jsContents.Add(text);
                      }
                  }
                  catch { }
              };

              await page.GotoAsync(url, new PageGotoOptions { Timeout = 60000 });
              await page.WaitForTimeoutAsync(3000);

              var inlineScripts = await page.EvalOnSelectorAllAsync<string[]>(
                  "script:not([src])",
                  "els => els.map(e => e.textContent)"
              );
              jsContents.AddRange(inlineScripts);

              var regex = new Regex(@"grecaptcha\.execute\(\s*['""]"
              + @"(?<sitekey>[^'""]+)['""]\s*,\s*\{[^}]*action\s*:\s*['""](?<action>[^'""]+)['""]", 
              RegexOptions.IgnoreCase);

              foreach (var js in jsContents)
              {
                  var match = regex.Match(js);
                  if (match.Success)
                  {
                      foundSitekey = match.Groups["sitekey"].Value;
                      foundAction = match.Groups["action"].Value;
                      break;
                  }
              }

              Console.WriteLine($"sitekey: {foundSitekey}");
              Console.WriteLine($"action: {foundAction}");

              await browser.CloseAsync();
          }
      }
      ```
    </details>
  </TabItem>
</Tabs>

## Usar biblioteca SDK

<Tabs className="full-width-tabs filled-tabs request-tabs" groupId="captcha-type">
  <TabItem value="js" label="JavaScript" default className="method-panel">
<details>
      <summary>Mostrar Código (para navegador)</summary> 
```js
// https://github.com/ZennoLab/capmonstercloud-client-js

import {
  CapMonsterCloudClientFactory,
  ClientOptions,
  RecaptchaV3ProxylessRequest
} from '@zennolab_com/capmonstercloud-client';

document.addEventListener('DOMContentLoaded', async () => {

  const cmcClient = CapMonsterCloudClientFactory.Create(
    new ClientOptions({ clientKey: 'YOUR_API_KEY' }) // Insira sua chave de API do CapMonster Cloud
  );

  // Se necessário, você pode verificar o saldo
  const balance = await cmcClient.getBalance();
  console.log('Balance:', balance);

  const recaptchaV3Request = new RecaptchaV3ProxylessRequest({
    websiteURL: 'https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta', // URL da sua página com a captcha
    websiteKey: '6Le0xVgUAAAAAIt20XEB4rVhYOODgTl00d8juDob',
    minScore: 0.6,  
    pageAction: 'myverify',
  });

  const solution = await cmcClient.Solve(recaptchaV3Request);
  console.log('Solution:', solution);

});
```
</details>

<details>
      <summary>Mostrar Código (Node.js)</summary>
```javascript
// https://github.com/ZennoLab/capmonstercloud-client-js

import { CapMonsterCloudClientFactory, ClientOptions, RecaptchaV3ProxylessRequest } from '@zennolab_com/capmonstercloud-client';

const API_KEY = "YOUR_API_KEY"; // Insira sua chave de API do CapMonster Cloud

async function solveRecaptchaV3() {
    const cmcClient = CapMonsterCloudClientFactory.Create(
        new ClientOptions({ clientKey: API_KEY })
    );

    // Se necessário, você pode verificar o saldo
    const balance = await cmcClient.getBalance();
    console.log("Balance:", balance);

    const recaptchaV3Request = new RecaptchaV3ProxylessRequest({
        websiteURL: "https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta", // URL da sua página com a captcha
        websiteKey: "6Le0xVgUAAAAAIt20XEB4rVhYOODgTl00d8juDob",
        minScore: 0.6,
        pageAction: "myverify",
    });

    const solution = await cmcClient.Solve(recaptchaV3Request);
    console.log("Solution:", solution);
}

solveRecaptchaV3().catch(console.error);
```
</details>

<BlogLink url="https://capmonster.cloud/pt-BR/blog/re-1/javascript-recaptcha-v3"/>

  </TabItem>

  <TabItem value="python" label="Python" className="method-panel">
<details>
      <summary>Mostrar Código</summary>
```python
# https://github.com/Zennolab/capmonstercloud-client-python

import asyncio
from capmonstercloudclient import CapMonsterClient, ClientOptions
from capmonstercloudclient.requests import RecaptchaV3ProxylessRequest

client_options = ClientOptions(api_key="YOUR_API_KEY")  # Insira sua chave de API do CapMonster Cloud
cap_monster_client = CapMonsterClient(options=client_options)

# Se necessário, você pode verificar o saldo
balance = asyncio.run(cap_monster_client.get_balance())
print("Balance:", balance)

recaptcha_v3_request = RecaptchaV3ProxylessRequest(
    websiteUrl="https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta",  # URL da sua página com captcha
    websiteKey="6Le0xVgUAAAAAIt20XEB4rVhYOODgTl00d8juDob",
    minScore=0.6,
    pageAction="myverify"
)

async def solve_captcha():
    return await cap_monster_client.solve_captcha(recaptcha_v3_request)

responses = asyncio.run(solve_captcha())
print(responses)
```
</details>

<BlogLink url="https://capmonster.cloud/pt-BR/blog/re-1/python-recaptcha-v3"/>

  </TabItem>

  <TabItem value="csharp" label="C#" className="method-panel">
<details>
      <summary>Mostrar Código</summary>
```csharp
// https://github.com/ZennoLab/capmonstercloud-client-dotnet

using Zennolab.CapMonsterCloud.Requests;
using Zennolab.CapMonsterCloud;

class Program
{
    static async Task Main(string[] args)
    {
        var clientOptions = new ClientOptions
        {
            ClientKey = "YOUR_API_KEY"  // Insira sua chave de API do CapMonster Cloud
        };

        var cmCloudClient = CapMonsterCloudClientFactory.Create(clientOptions);

        // Se necessário, você pode verificar o saldo
        var balance = await cmCloudClient.GetBalanceAsync();
        Console.WriteLine("Balance: " + balance);

        var recaptchaV3Request = new RecaptchaV3ProxylessRequest
        {
            WebsiteUrl = "https://lessons.zennolab.com/captchas/recaptcha/v3.php?level=beta",  // URL da sua página com captcha
            WebsiteKey = "6Le0xVgUAAAAAIt20XEB4rVhYOODgTl00d8juDob",
            MinScore = 0.6,
            PageAction = "myverify"
        };

        var recaptchaV3Result = await cmCloudClient.SolveAsync(recaptchaV3Request);

        Console.WriteLine("Solution: " + recaptchaV3Result.Solution.Value);
    }
}
```
</details>

<BlogLink url="https://capmonster.cloud/pt-BR/blog/re-1/c-recaptcha-v3"/>

  </TabItem>
</Tabs>

