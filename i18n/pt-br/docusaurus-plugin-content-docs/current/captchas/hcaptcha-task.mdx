---
sidebar_position: 5
sidebar_label: HCaptchaTask
draft: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ParamItem from '@theme/ParamItem';
import MethodItem from '@theme/MethodItem';
import MethodDescription from '@theme/MethodDescription'
import PriceBlock from '@theme/PriceBlock';
import PriceBlockWrap from '@theme/PriceBlockWrap';
import { ArticleHead } from '../../../../../src/theme/ArticleHead';

<ArticleHead slug="captchas/hcaptcha-task" />

# HCaptchaTask

<PriceBlockWrap>
  <PriceBlock title="hCaptcha" name="hCaptchaToken"/>
  <PriceBlock title="hCaptcha Enterprise" name="hCaptchaEnterpriseToken"/>
</PriceBlockWrap>


Esta seção contém informações sobre a tarefa de resolução do hCaptcha. Para fornecer uma universalidade sólida na resolução desse tipo de tarefa, reproduzimos cada parte do ambiente utilizado para a tarefa de automação que você planeja concluir. Isso inclui: acesso ao proxy, user-agent do navegador, cookies (opcionalmente). Essa abordagem eliminará todos os possíveis obstáculos que possam surgir no futuro.

Esse tipo de captcha pode demorar um pouco mais para ser resolvido do que um captcha de imagem comum, mas essa questão é compensada pelo fato de que o valor de `g-captcha-response` que enviamos a você é válido pelos próximos 60 segundos após resolvermos seu Captcha.

:::warning **Atenção!**
O CapMonster Cloud, por padrão, funciona com proxies integrados — já incluídos no custo do serviço. É necessário especificar seus próprios proxies apenas nos casos em que o site não aceita o token ou quando o acesso aos serviços integrados está restrito.

Se o proxy utiliza autenticação por IP, é necessário adicionar o endereço **65.21.190.34** à lista de permissões (whitelist).
:::

## Parâmetros da solicitação

<Tabs className="full-width-tabs filled-tabs" groupId="captcha-type">
<TabItem value="proxyless" label="HCaptchaTask (sem proxy)" default className="bordered-panel">
    <ParamItem title="type" required type="string" />
    **HCaptchaTask**

    ---

    <ParamItem title="websiteURL" required type="string" />
    Endereço de uma página da web com hCaptcha.

    ---

    <ParamItem title="websiteKey" required type="string" />
    Chave do site hCaptcha.

    ---

    <ParamItem title="isInvisible" type="boolean" />
    Use true para a versão invisível do hCaptcha.

    ---

    <ParamItem title="data" type="string" />
    <p>Dados personalizados usados em algumas implementações do hCaptcha, principalmente com `isInvisible=true`.</p>

    ---

    <ParamItem title="userAgent" type="string" />
    **Forneça apenas o UA real do sistema operacional Windows. Agora é:** userAgentPlaceholder

    ---

    <ParamItem title="cookies" type="string" />
    <p>Cookies adicionais que devemos usar durante a interação com a página de destino.</p><p>**Formato**: cookiename1=cookievalue1; cookiename2=cookievalue2</p>

    ---

    <ParamItem title="fallbackToActualUA" type="boolean" />
    <p>**true** - ao especificar este parâmetro, ignoramos o User Agent irrelevante que os usuários enviam na solicitação e retornamos o nosso próprio (relevante) com getTaskResult. Isso melhorará a aceitação de tokens.</p><p>**false** - inserimos o User Agent especificado na solicitação. Se o User Agent for inválido, você receberá um erro ERROR_WRONG_USERAGENT (USERAGENT EXPIRED no log).</p>

  </TabItem>
  <TabItem value="proxy" label="HCaptchaTask (usando proxy)" className="bordered-panel">
    <ParamItem title="type" required type="string" />
    **HCaptchaTask**

    ---

    <ParamItem title="websiteURL" required type="string" />
    Endereço de uma página da web com hCaptcha.

    ---

    <ParamItem title="websiteKey" required type="string" />
    Chave do site hCaptcha.

    ---

    <ParamItem title="isInvisible" type="boolean" />
    Use true para a versão invisível do hCaptcha.

    ---

    <ParamItem title="data" type="string" />
    <p>Dados personalizados usados em algumas implementações do hCaptcha, principalmente com `isInvisible=true`.</p>

    ---

    <ParamItem title="userAgent" type="string" />
    **Forneça apenas o UA real do sistema operacional Windows. Agora é:** userAgentPlaceholder

    ---

    <ParamItem title="cookies" type="string" />
    <p>Cookies adicionais que devemos usar durante a interação com a página de destino.</p><p>**Formato**: cookiename1=cookievalue1; cookiename2=cookievalue2</p>

    ---

    <ParamItem title="fallbackToActualUA" type="boolean" />
    <p>**true** - ao especificar este parâmetro, ignoramos o User Agent irrelevante que os usuários enviam na solicitação e retornamos o nosso próprio (relevante) com getTaskResult. Isso melhorará a aceitação de tokens.</p><p>**false** - inserimos o User Agent especificado na solicitação. Se o User Agent for inválido, você receberá um erro ERROR_WRONG_USERAGENT (USERAGENT EXPIRED no log).</p>

    ---

    <ParamItem title="proxyType" required type="string" />
    **http** - proxy http/https comum;<br />**https** - tente esta opção apenas se "http" não funcionar (necessário para alguns proxies personalizados);<br />**socks4** - proxy socks4;<br />**socks5** - proxy socks5.

    ---

    <ParamItem title="proxyAddress" required type="string" />
    <p>
      Endereço IP do proxy IPv4/IPv6. Não é permitido:
      - uso de nomes de host;
      - uso de proxies transparentes (onde é possível ver o IP do cliente);
      - uso de proxies em máquinas locais.
    </p>

    ---

    <ParamItem title="proxyPort" required type="integer" />
    Porta do proxy.

    ---

    <ParamItem title="proxyLogin" type="string" />
    Login do servidor proxy.

    ---

    <ParamItem title="proxyPassword" type="string" />
    Senha do servidor proxy.

  </TabItem>
  
</Tabs>

## Tipos de tarefas suportados

Todos os principais tipos de tarefas são suportados, por exemplo:

* **DragAndDrop** – arrastar elementos para as posições corretas
* **Click** – clicar em um elemento
* **3x3 / YesNo** – selecionar imagens de acordo com a condição fornecida


## Método Create task

<Tabs className="full-width-tabs filled-tabs request-tabs" groupId="captcha-type">
<TabItem value="proxyless" label="HCaptchaTask (sem proxy)" default className="method-panel">
    <MethodItem>
      ```http
      https://api.capmonster.cloud/createTask
      ```
    </MethodItem>
<MethodDescription>
**Solicitação**
```json
{
    "clientKey":"API_KEY",
    "task":
    {
        "type":"HCaptchaTask",
        "websiteURL":"https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
        "websiteKey":"472fc7af-86a4-4382-9a49-ca9090474471",
        "userAgent": "userAgentPlaceholder",
        "fallbackToActualUA":true
    }
}
```
**Resposta**
```json
{
  "errorId":0,
  "taskId":407533072
}
```

</MethodDescription>
  </TabItem>
  <TabItem value="proxy" label="HCaptchaTask (usando proxy)" className="method-panel">
<MethodItem>
  ```http
  https://api.capmonster.cloud/createTask
  ```
</MethodItem>
<MethodDescription>
**Solicitação**
```json
{
    "clientKey":"API_KEY",
    "task":
    {
        "type":"HCaptchaTask",
        "websiteURL":"https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
        "websiteKey":"472fc7af-86a4-4382-9a49-ca9090474471",
        "userAgent": "userAgentPlaceholder",
        "fallbackToActualUA":true,
        "proxyType":"http",
        "proxyAddress":"8.8.8.8",
        "proxyPort":8080,
        "proxyLogin":"proxyLoginHere",
        "proxyPassword":"proxyPasswordHere"
    }
}
```
**Resposta**
```json
{
  "errorId":0,
  "taskId":407533072
}
```
</MethodDescription>
  </TabItem>
  
</Tabs>


## Método Get task result
Use o método [getTaskResult](../api/methods/get-task-result.mdx) para solicitar a resposta do hCaptcha. Você receberá uma resposta no período de 10 a 80 segundos, dependendo da carga de trabalho do serviço.

<TabItem value="proxyless" label="HCaptchaTask (sem proxy)" default className="method-panel-full">
    <MethodItem>
```http
https://api.capmonster.cloud/getTaskResult
```
    </MethodItem>
    <MethodDescription>
**Solicitação**
```json
{
  "clientKey":"API_KEY",
  "taskId": 407533072
}
```
**Resposta**
```json
{
  "errorId":0,
  "status":"ready",
  "solution": {
    "gRecaptchaResponse": "P1_eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.hKdwYXNza2V5xQb9JvlblBqjTdKpourvlRNpOZLvJb0yJRmsXVFVjyxFWlL1wdYBXaPyFtnxwy2ukbMgwWn62-cjSc98Iw2XIPYWg5MNDKS4_7tBIhjY0PienoKy1...",
    "respKey": "E0_eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoidjQ3RjlqZGFYTllFQXlZZFYyRTlaWlBVQUdLaFpPakpRNjBXRTljVW40VnY3NnhuN2V3R0wwVWd1MW1Wai90WEdoYmt5a2NqVGlGdWpsSlpmVjcza...",
    "userAgent": "userAgentPlaceholder"
  }
}
```
  </MethodDescription>
  </TabItem>

<br />

|**Propriedade**|**Tipo**|**Descrição**|
| :- | :- | :- |
|gRecaptchaResponse|String|Hash que deve ser inserido no formulário de envio do hCaptcha no site de destino.|
|userAgent|String|Durante o envio, você deve usar o mesmo *User Agent* com o qual o hCaptcha foi resolvido.|
|respKey|String|O resultado da função "window.hcaptcha.getRespKey()" quando disponível. Alguns sites usam esse valor para verificação adicional.|

---

# Obtendo os parâmetros do hCaptcha

Para resolver o hCaptcha com sucesso via API, você deve obter os parâmetros obrigatórios da página: `websiteKey` e, para a versão Invisible — também `data` (`rqdata`).

Abaixo estão os principais métodos para localizá-los.

---

## 1. Parâmetro `websiteKey`

### Método 1: Usando a aba Network

1. Abra as **Ferramentas do Desenvolvedor (DevTools)**.
2. Vá para a aba **Network**.
3. Recarregue a página com o hCaptcha.
4. Na lista de requisições, encontre uma URL que comece com:

```

checksiteconfig?v=

```

5. Para uma busca rápida, pressione:

   * **Ctrl + F** (Windows)
   * **Command + F** (macOS)

   e digite a palavra-chave:

```

key

```

O parâmetro `sitekey` aparecerá nas requisições correspondentes — este é o valor de `websiteKey`.

---

### Método 2: Usando a aba Elements

1. Abra a aba **Elements**.
2. Procure na página por:

   * `data-sitekey`
   * `sitekey`

Na maioria dos casos, o parâmetro aparece assim:

```html
<div class="h-captcha" data-sitekey="XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"></div>
```

O valor do atributo `data-sitekey` é o seu `websiteKey`.

---

## 2. Parâmetro `data` (rqdata) — para HCaptcha Invisible

Em alguns sites (especialmente ao usar a versão Invisible), o parâmetro adicional `rqdata` é obrigatório.

### Importante

O valor `rqdata`:

* é **de uso único**;
* é regenerado cada vez que a página é atualizada;
* não pode ser reutilizado — usar um valor antigo resultará em erro.

---

### Método 1: Procurando no código-fonte da página

Às vezes, o parâmetro pode ser encontrado diretamente no código JavaScript, por exemplo:

```js
hcaptcha.setData({ rqdata: "value" })
```

Nesse caso, `"value"` é o parâmetro `data` necessário.

---

### Método 2: Usando a aba Network

1. Abra **DevTools → Network**.
2. Recarregue a página com a captcha.
3. Pressione **Ctrl + F** (ou Command + F no macOS).
4. No campo de busca, digite:

```
data
```

Na maioria das vezes, o parâmetro aparece em requisições relacionadas a:

* autorização (`login`)
* registro (`signup`)
* confirmações de ação

Revise essas requisições e localize o campo `rqdata`.

---

## 3. Procurando parâmetros na requisição `refreshcaptcha`

Em alguns sites, os parâmetros do hCaptcha são enviados por meio de uma requisição especial:

```
refreshcaptcha
```

### Etapas:

1. Abra **DevTools → Network**.
2. Recarregue a página.
3. Encontre a requisição `refreshcaptcha`.
4. Vá para a aba **Response**.

Para o serviço CapMonster Cloud, os seguintes parâmetros são necessários neste caso:

* `gid`
* `sitekey`

### Importante

O valor `gid` corresponde ao parâmetro `data`.

Ao criar a requisição de resolução:

* `sitekey` → use como `websiteKey`
* `gid` → use como `data`

---

## 4. Procurando parâmetros nas requisições da API do site

Às vezes, os parâmetros do hCaptcha não estão visíveis diretamente, mas estão incluídos em requisições internas da API do site.

Essas requisições geralmente ocorrem:

* durante a autorização,
* durante o registro,
* ao enviar um formulário.

Por exemplo:

```
https://authenticate.example.com/api/v1/login
```

Abra a requisição correspondente na aba **Network** e verifique:

* o corpo da requisição (Request Payload),
* a resposta do servidor (Response).

Parâmetros como `sitekey`, `rqdata` e `gid` podem estar incluídos nesses dados.

---

## Recomendações

* Sempre atualize a página antes de copiar o `rqdata`.
* Certifique-se de que os parâmetros não são gerados dinamicamente.
* Se o parâmetro não estiver presente no HTML, verifique as requisições na aba Network.

---

## Usar biblioteca SDK

<Tabs className="full-width-tabs filled-tabs request-tabs" groupId="captcha-type">
  <TabItem value="js" label="JavaScript" default className="method-panel">
<details>
      <summary>Mostrar Código (para navegador)</summary>
```js
// https://github.com/ZennoLab/capmonstercloud-client-js

import { CapMonsterCloudClientFactory, ClientOptions, HCaptchaRequest } from '@zennolab_com/capmonstercloud-client';

const API_KEY = "YOUR_API_KEY";  // Insira sua chave de API do CapMonster Cloud

document.addEventListener("DOMContentLoaded", async () => {
    const client = CapMonsterCloudClientFactory.Create(
        new ClientOptions({ clientKey: API_KEY })
    );

    // Exemplo básico sem proxy
    // O CapMonster Cloud usa automaticamente seus próprios proxies
    let hcaptchaRequest = new HCaptchaRequest({
        websiteURL: "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy", // URL da página com hCaptcha
        websiteKey: "472fc7af-86a4-4382-9a49-ca9090474471",
        isInvisible: false,                         // true -- se for usado o hCaptcha Invisível
        data: "rqdata_value_if_required"            // Obrigatório para algumas implementações do Invisible
    });

    // Exemplo de uso do seu próprio proxy
    // Descomente este bloco se quiser usar um proxy personalizado
    /*
    const proxy = {
        proxyType: "http",
        proxyAddress: "123.45.67.89",
        proxyPort: 8080,
        proxyLogin: "username",
        proxyPassword: "password"
    };

    hcaptchaRequest = new HCaptchaRequest({
        websiteURL: "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
        websiteKey: "472fc7af-86a4-4382-9a49-ca9090474471",
        isInvisible: false,
        data: "rqdata_value_if_required",
        proxy,
        userAgent: "userAgentPlaceholder"
    });
    */

    // Se necessário, você pode verificar o saldo
    const balance = await client.getBalance();
    console.log("Balance:", balance);

    const result = await client.Solve(hcaptchaRequest);
    console.log("Solution:", result);
});
```

</details>

<details>
      <summary>Mostrar Código (Node.js)</summary>
```javascript
// https://github.com/ZennoLab/capmonstercloud-client-js

import { CapMonsterCloudClientFactory, ClientOptions, HCaptchaRequest } from '@zennolab_com/capmonstercloud-client';

const API_KEY = "YOUR_API_KEY";  // Insira sua chave de API do CapMonster Cloud

async function solveHCaptcha() {
    const client = CapMonsterCloudClientFactory.Create(
        new ClientOptions({ clientKey: API_KEY })
    );

    // Exemplo básico sem proxy
    // O CapMonster Cloud usa automaticamente seus próprios proxies
    let hcaptchaRequest = new HCaptchaRequest({
        websiteURL: "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy", // URL da página com hCaptcha
        websiteKey: "472fc7af-86a4-4382-9a49-ca9090474471",
        isInvisible: false,                         // true -- se for usado o hCaptcha Invisível
        data: "rqdata_value_if_required"            // Obrigatório para algumas implementações do Invisible
    });

    // Exemplo de uso do seu próprio proxy
    // Descomente este bloco se quiser usar um proxy personalizado

    /*
    const proxy = {
        proxyType: "http",
        proxyAddress: "123.45.67.89",
        proxyPort: 8080,
        proxyLogin: "username",
        proxyPassword: "password"
    };

    hcaptchaRequest = new HCaptchaRequest({
        websiteURL: "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
        websiteKey: "472fc7af-86a4-4382-9a49-ca9090474471",
        isInvisible: false,
        data: "rqdata_value_if_required",
        proxy,
        userAgent: "userAgentPlaceholder"
    });
    */

    // Se necessário, você pode verificar o saldo
    const balance = await client.getBalance();
    console.log("Balance:", balance);

    const result = await client.Solve(hcaptchaRequest);
    console.log("Solution:", result);
}

solveHCaptcha().catch(console.error);
```

</details>


</TabItem>

 <TabItem value="python" label="Python" default className="method-panel">
<details>
      <summary>Mostrar Código</summary>
```python
# https://github.com/ZennoLab/capmonstercloud-client-python

import asyncio
from capmonstercloudclient import CapMonsterClient, ClientOptions
from capmonstercloudclient.requests import HcaptchaRequest
# from capmonstercloudclient.requests.baseRequestWithProxy import ProxyInfo  # Descomente se planeja usar proxy

API_KEY = "YOUR_API_KEY"  # Insira sua chave de API do CapMonster Cloud

async def solve_hcaptcha():
    client_options = ClientOptions(api_key=API_KEY)
    cap_monster_client = CapMonsterClient(options=client_options)

    # Exemplo básico sem proxy
    # O CapMonster Cloud usa automaticamente seus próprios proxies
    hcaptcha_request = HcaptchaRequest(
        websiteUrl="https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",  # URL da página com hCaptcha
        websiteKey="472fc7af-86a4-4382-9a49-ca9090474471",
        isInvisible=False,                      # True, se for hCaptcha invisível
        userAgent="userAgentPlaceholder",
        fallbackToActualUA=True
    )

    # Exemplo de uso do seu próprio proxy
    # Descomente este bloco se quiser usar um proxy personalizado

    # proxy = ProxyInfo(
    #     proxyType="http",
    #     proxyAddress="123.45.67.89",
    #     proxyPort=8080,
    #     proxyLogin="username",
    #     proxyPassword="password"
    # )
    #
    # hcaptcha_request = HcaptchaRequest(
    #     websiteUrl="https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
    #     websiteKey="472fc7af-86a4-4382-9a49-ca9090474471",
    #     isInvisible=False,
    #     userAgent="userAgentPlaceholder",
    #     fallbackToActualUA=True,
    #     proxy=proxy
    # )

    # Se necessário, você pode verificar o saldo
    balance = await cap_monster_client.get_balance()
    print("Balance:", balance)

    result = await cap_monster_client.solve_captcha(hcaptcha_request)
    print("Solution:", result)

asyncio.run(solve_hcaptcha())    
```
</details>
  </TabItem>

  <TabItem value="csharp" label="C#" className="method-panel">
<details>
      <summary>Mostrar Código</summary>
```csharp
// https://github.com/ZennoLab/capmonstercloud-client-dotnet

using System;
using System.Threading.Tasks;
using Zennolab.CapMonsterCloud;
using Zennolab.CapMonsterCloud.Requests;

class Program
{
    static async Task Main(string[] args)
    {
        // Insira sua chave de API do CapMonster Cloud
        var clientOptions = new ClientOptions
        {
            ClientKey = "YOUR_API_KEY"
        };

        var cmCloudClient = CapMonsterCloudClientFactory.Create(clientOptions);

        // Exemplo básico sem proxy
        // O CapMonster Cloud usa automaticamente seus próprios proxies
        var hcaptchaRequest = new HCaptchaRequest
        {
            WebsiteUrl = "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy", // URL da página com hCaptcha
            WebsiteKey = "472fc7af-86a4-4382-9a49-ca9090474471",
            Invisible = false,                          // true -- se for hCaptcha invisível
            UserAgent = "userAgentPlaceholder"
        };

        // Exemplo de uso do seu próprio proxy
        // Descomente este bloco se quiser usar um proxy personalizado

        /*
        hcaptchaRequest = new HCaptchaRequest
        {
            WebsiteUrl = "https://lessons.zennolab.com/captchas/hcaptcha/?level=easy",
            WebsiteKey = "472fc7af-86a4-4382-9a49-ca9090474471",
            Invisible = false,
            UserAgent = "userAgentPlaceholder",

            Proxy = new ProxyContainer(
                "123.45.67.89",
                8080,
                ProxyType.Http,
                "username",
                "password"
            )
        };
        */

        // Se necessário, você pode verificar o saldo
        var balance = await cmCloudClient.GetBalanceAsync();
        Console.WriteLine("Balance: " + balance);

        var hcaptchaResult = await cmCloudClient.SolveAsync(hcaptchaRequest);

        Console.WriteLine("HCaptcha Solution: " + hcaptchaResult.Solution.Value);
    }
}
```
</details>
  </TabItem>  
</Tabs>