---
sidebar_position: 11
sidebar_label: DataDome
title: "Автоматическое распознавание и обход DataDome капч | API"
description: "Узнайте, как обойти капчу DataDome через API Capmonster Cloud! Инструкция по использованию метода DataDome позволит настроить автоматическое распознавание и решение DataDome капчи!"
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ParamItem from '@theme/ParamItem';
import MethodItem from '@theme/MethodItem';
import MethodDescription from '@theme/MethodDescription'
import PriceBlock from '../../src/theme/PriceBlock';
import PriceBlockWrap from '@theme/PriceBlockWrap';
import { ArticleHead } from '../../src/theme/ArticleHead';

<ArticleHead slug="captchas/datadome" />

# DataDome

<PriceBlockWrap>
  <PriceBlock title="DataDome" captchaId="datadome"/>
</PriceBlockWrap>

Данный тип капчи в основном требует от пользователя решить головоломку, перемещая ползунок для подтверждения. 

![](./images/datadome/datadome.png)

:::warning **Внимание!**
* Для выполнения данной задачи используйте **ваши собственные прокси**.

* Если прокси с авторизацией по IP, то необходимо добавить адрес **65.21.190.34** в белый список.

* После решения вы получите **специальные cookie**, которые необходимо добавить в браузер.
:::


## Параметры запроса

<TabItem value="proxyless" label="CustomTask (без прокси)" default className="bordered-panel">
    <ParamItem title="type" required type="string" />
    **CustomTask**

    ---

    <ParamItem title="class" required type="string" />
    **DataDome**

    ---

    <ParamItem title="websiteURL" required type="string" />
    Адрес основной страницы, на которой решается капча.

    ---

    <ParamItem title="captchaUrl (внутри metadata)" required="required" type="string" />
    `"captchaUrl"` - ссылка на капчу. Обычно имеет следующий вид: `"https://geo.captcha-delivery.com/captcha/?initialCid=..."`.

    ---

    <ParamItem title="datadomeCookie (внутри metadata)" required type="string" />
    Ваши куки от datadome. Можно получить на странице с помощью `document.cookie` (если куки не имеют флага *HttpOnly*), в заголовке запроса Set-Cookie: "datadome=...", либо напрямую из HTML-кода страницы `initialCid` ([*см. примеры, как найти datadomeCookie*](#как-найти-datadomecookie))

    ---

    <ParamItem title="proxyType" required type="string" />
    **http** - обычный http/https прокси;<br />
	**https** - попробуйте эту опцию только если "http" не работает (требуется для некоторых кастомных прокси);<br />
	**socks4** - socks4 прокси;<br />
	**socks5** - socks5 прокси.

     ---

    <ParamItem title="proxyAddress" required type="string" />
    <p>
      IP адрес прокси IPv4/IPv6. Не допускается:
		- использование прозрачных прокси (там где можно видеть IP клиента);
		- использование прокси на локальных машинах.
    </p>

     ---

    <ParamItem title="proxyPort" required type="integer" />
    Порт прокси.

     ---

    <ParamItem title="proxyLogin" required type="string" />
    Логин прокси-сервера.

     ---

    <ParamItem title="proxyPassword" required type="string" />
    Пароль прокси-сервера.

	 ---
	 
    <ParamItem title="userAgent" type="string" />
    User-Agent браузера. <br />
  **Передавайте только актуальный UA от ОС Windows. Сейчас таковым является**: `userAgentPlaceholder`
	
     ---
</TabItem>


## Метод создания задачи

:::warning **Важно**
В процессе загрузки на странице DataDome может использовать один из двух скриптов: `c.js` или `i.js`.
Если на целевом сайте используется `c.js`, извлечённые куки могут не сработать при подтверждении решения. Перед решением рекомендуется проверить, какой скрипт загружается (**DevTools → Network / HTML**).
:::

**Вариант с `c.js`:**

![](./images/datadome/datadome_cjs.png)

**Вариант с `i.js`:**

![](./images/datadome/datadome_ijs.png)

<TabItem value="proxyless" label="CustomTask (без прокси)" default className="method-panel">
	<MethodItem>
		```http
		https://api.capmonster.cloud/createTask
		```
	</MethodItem>
	<MethodDescription>
		**Запрос**
```json
{
  "clientKey": "API_KEY",
  "task": {
    "type": "CustomTask",
    "class": "DataDome",
    "websiteURL": "https://example.com",
    "userAgent": "userAgentPlaceholder",
    "metadata": {
      "captchaUrl": "https://geo.captcha-delivery.com/interstitial/?initialCid=AHrlqAAAAAMA9UvsL58YLqIAXNLFPg%3D%3D&hash=C0705ACD75EBF650A07FF8291D3528&cid=7sfa5xUfDrR4bQTp1c2mhtiD7jj9TXExcQypjdNAxKVFyIi1S9tE0~_mqLa2EFpOuzxKcZloPllsNHjNnqzD9HmBA4hEv7SsEyPYEidCBvjZEaDyfRyzefFfolv0lAHM&referer=https%3A%2F%2Fwww.example.com.au%2F&s=6522&b=978936&dm=cm",
      "datadomeCookie": "datadome=VYUWrgJ9ap4zmXq8Mgbp...64emvUPeON45z"
    },
    "proxyType": "http",
    "proxyAddress": "123.45.67.89",
    "proxyPort": 8080,
    "proxyLogin": "proxyUsername",
    "proxyPassword": "proxyPassword"
  }
}
```
		**Ответ**
		```json
		{
		  "errorId":0,
		  "taskId":407533072
		}
		```
	</MethodDescription>
</TabItem>


## Метод получения результата задачи
Используйте метод [getTaskResult](../api/methods/get-task-result.mdx), чтобы получить решение DataDome.

<TabItem value="proxyless" label="CustomTask (без прокси)" default className="method-panel-full">
	<MethodItem>
		```http
		https://api.capmonster.cloud/getTaskResult
		```
	</MethodItem>
	<MethodDescription>
		**Запрос**
		```json
		{
		  "clientKey":"API_KEY",
		  "taskId": 407533072
		}
		```
		**Ответ**

```json
{
  "errorId": 0,
  "status": "ready",
  "solution": {
    "domains": {
      "www.example.com": {
        "cookies": {
          "datadome": "P1w0VnjFcTFslfps0J4FaPpY_QPbPBW4MeYxj4LW~pztIfJiSSuBPr8oQTUHzdrfgv137FbOBd3kCUOOgny7LhIkhm5e1qdtzYM4s2e46U_qfERK4KiCy22MOSIDsDyh"
        },
        "localStorage": null
      }
    },
    "url": null,
    "fingerprint": null,
    "headers": null,
    "data": null
  }
}
```
	</MethodDescription>
</TabItem>

## Как найти `datadomeCookie`

### Через Инструменты разработчика

**Вариант 1:**

1. Откройте сайт, защищённый DataDome, в браузере (Chrome, Firefox).

2. Нажмите F12 → откройте вкладку **Application** → **Cookies**.

3. Найдите домен сайта (например, www.example.com).

Среди cookie будет ключ datadome — это нужный параметр `datadomeCookie`.

![](./images/datadome/datadomeCookie.png)

**Вариант 2:**

1. Откройте сайт, где срабатывает DataDome-капча.

2. Перейдите в **DevTools** → **Network**, перезагрузите страницу и найдите запрос, в котором загружается страница с параметром `initialCid`.

Пример URL:

`https://geo.captcha-delivery.com/interstitial/?initialCid=...&hash=...&cid=...`

![](./images/datadome/datadomeCookie3.png)

или:

3. Откройте **Response** этого запроса. В HTML-коде страницы найдите объект:

`var ddm = { ... };`


4. Внутри этого объекта будет параметр `cid`. Его значение и есть актуальное значение cookie datadome.

![](./images/datadome/datadomeCookie1.png)

**Вариант 3:**

1. Откройте сайт, где срабатывает DataDome-капча.

2. Перейдите в **DevTools** → **Network**, перезагрузите страницу и найдите запрос со статусом **403**.

3. Перейдите на вкладку **Headers → Response Headers**. В списке заголовков найдите `Set-Cookie:` и скопируйте значение параметра `datadome` (формат `datadome=<значение>`).

![](./images/datadome/datadomeCookie2.png)

{/* ## Используйте библиотеку SDK

<Tabs className="full-width-tabs filled-tabs request-tabs" groupId="captcha-type">
  <TabItem value="js" label="JavaScript" default className="method-panel">
    ```js
    // https://github.com/ZennoLab/capmonstercloud-client-js

    import { CapMonsterCloudClientFactory, ClientOptions, DataDomeRequest } from '@zennolab_com/capmonstercloud-client';

    document.addEventListener('DOMContentLoaded', async () => {
      const cmcClient = CapMonsterCloudClientFactory.Create(new ClientOptions({ clientKey: '<your capmonster.cloud API key>' }));
      console.log(await cmcClient.getBalance());

      const dataDomeRequest = new DataDomeRequest({
        websiteURL: 'https://example.com',
        userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5.1 Mobile/21F90 Safari/604.1',
        metadata: {
          captchaUrl: 'https://geo.captcha-delivery.com/captcha/?initialCid=12434324',
          datadomeCookie: '',
        },
      });

      console.log(await cmcClient.Solve(dataDomeRequest));
    });
    ```
  </TabItem>

  <TabItem value="python" label="Python" className="method-panel">
    ```python
    # https://github.com/ZennoLab/capmonstercloud-client-python

    import asyncio
    from capmonstercloudclient import CapMonsterClient, ClientOptions
    from capmonstercloudclient.requests import DataDomeCustomTaskProxylessRequest

    client_options = ClientOptions(api_key="your_api_key")  # Replace with your CapMonster Cloud API key
    cap_monster_client = CapMonsterClient(options=client_options)

    data_dome_request = DataDomeCustomTaskProxylessRequest(
        websiteUrl="https://example.com",  # URL with the captcha

        userAgent="Mozilla/5.0 (iPhone; CPU iPhone OS 17_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5.1 Mobile/21F90 Safari/604.1",  # Use the current userAgent
        metadata={
            "htmlPageBase64": "PGh0bWw+PGhlYWQ+PHRpdGxlPn...+48L2h0bWw+",  # Replace with your HTML base64 or use captchaUrl
            "datadomeCookie": "datadome=oZJnhpo...1PuyGg"  # Replace with your DataDome cookie
        }
    )

    async def solve_captcha():
        return await cap_monster_client.solve_captcha(data_dome_request)

    responses = asyncio.run(solve_captcha())
    print(responses)
    ```
  </TabItem>
  
	<TabItem value="csharp" label="C#" className="method-panel">
		```csharp
		// https://github.com/ZennoLab/capmonstercloud-client-dotnet

		using Zennolab.CapMonsterCloud.Requests;
		using Zennolab.CapMonsterCloud;

		class Program
		{
			static async Task MainDatadome(string[] args)
			{
				var clientOptions = new ClientOptions
				{
					ClientKey = "your_api_key" // Replace with your CapMonster Cloud API key
				};

				var cmCloudClient = CapMonsterCloudClientFactory.Create(clientOptions);

				var DataDomeRequest = new DataDomeCustomTaskRequest(datadomeCookie: "datadome=6BvxqELMoorFNoo7GT1...JyfP_mhz", captchaUrl: "https://example.com", htmlPageBase64: "PGh0bWw+PGhlYWQ+PHRpdGxlPmJs...N0E5QTA1")
				{
					WebsiteUrl = "https://example.com",
					UserAgent = "Mozilla/5.0 (iPhone; CPU iPhone OS 17_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5.1 Mobile/21F90 Safari/604.1", // Use the current userAgent
				};

				var DataDomeResult = await cmCloudClient.SolveAsync(DataDomeRequest);

				Console.WriteLine("Captcha Solution: " + JsonSerializer.Serialize(DataDomeResult.Solution));
			}
		}
		```
	</TabItem>
</Tabs> */}
